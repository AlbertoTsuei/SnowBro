"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[564],{8564:function(t,a,s){s.r(a),s.d(a,{default:function(){return H}});var e=s(6252),i=s(3577),o=s(9963);const l={class:"container"},n=(0,e._)("div",{class:"loading-ice"},null,-1),c=(0,e.uE)('<ul class="cart-intro"><li class="cart-card"><div class="cardImg cart-now cart-now-border"><span class="material-icons"> shopping_cart </span></div><h4 class="cart-now">STEP.1</h4><p class="cart-now">確認選購</p></li><li class="cart-card"><div class="cardImg"><span class="material-icons"> format_list_bulleted </span></div><h4>STEP.2</h4><p>資料填寫</p></li><li class="cart-card"><div class="cardImg"><span class="material-icons"> done </span></div><h4>STEP.3</h4><p>預定成功</p></li></ul>',1),d={key:0},r={class:"text-end"},u=["disabled"],p=(0,e._)("div",null,null,-1),h={class:"table align-middle"},g=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th"),(0,e._)("th",null,"品名"),(0,e._)("th",null,"數量/單位"),(0,e._)("th",null,"單價")])],-1),_=["onClick","disabled"],m={class:"input-group input-group-sm"},b={class:"input-group"},v=["onUpdate:modelValue","onChange","disabled"],f=["value"],C={class:"input-group-text",id:"basic-addon2"},k={class:"text-end"},w=(0,e._)("small",null,"品項金額：",-1),$=(0,e._)("td",null,null,-1),y=(0,e._)("td",null,null,-1),L=(0,e._)("td",null,null,-1),x=(0,e._)("td",null,null,-1),D={class:"text-end text-success"},S={key:0,class:"text-info"},M=(0,e._)("br",null,null,-1),T={class:"input-group mb-3 input-group-sm"},P={class:"input-group-append"},I=["disabled"],z={key:1},q=(0,e._)("div",{class:"mt-3 cart-view-banner"},null,-1),U=(0,e._)("h4",{class:"mt-3 text-info text-center"},"購物車目前沒有商品",-1);function E(t,a,s,E,A,F){const V=(0,e.up)("vue-loading");return(0,e.wg)(),(0,e.iD)("div",l,[(0,e.Wm)(V,{active:A.isLoading,"is-full-page":A.fullPage,"background-color":"black"},{default:(0,e.w5)((()=>[n])),_:1},8,["active","is-full-page"]),c,A.cartData.total?((0,e.wg)(),(0,e.iD)("div",d,[(0,e._)("div",r,[(0,e._)("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...t)=>F.removeAllCart&&F.removeAllCart(...t)),disabled:0==A.cartData.final_total||1===A.isLoadingitem}," 清空購物車 ",8,u)]),p,(0,e._)("table",h,[g,(0,e._)("tbody",null,[A.cartData.carts?((0,e.wg)(!0),(0,e.iD)(e.HY,{key:0},(0,e.Ko)(A.cartData.carts,(a=>((0,e.wg)(),(0,e.iD)("tr",{key:a.id},[(0,e._)("td",null,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>F.removeCartItem(a.id),disabled:A.isLoadingitem===a.id}," x ",8,_)]),(0,e._)("td",null,(0,i.zw)(a.product.title),1),(0,e._)("td",null,[(0,e._)("div",m,[(0,e._)("div",b,[(0,e.wy)((0,e._)("select",{id:"",class:"form-select","onUpdate:modelValue":t=>a.qty=t,onChange:t=>F.updateCartItem(a),disabled:A.isLoadingitem===a.id},[((0,e.wg)(),(0,e.iD)(e.HY,null,(0,e.Ko)(20,(t=>(0,e._)("option",{value:t,key:`${t}${a.id}`},(0,i.zw)(t),9,f))),64))],40,v),[[o.bM,a.qty]]),(0,e._)("span",C,(0,i.zw)(a.product.unit),1)])])]),(0,e._)("td",null,(0,i.zw)(t.$filters.currency(a.product.price)),1),(0,e._)("td",k,[w,(0,e.Uk)(" "+(0,i.zw)(t.$filters.currency(a.total)),1)])])))),128)):(0,e.kq)("",!0)]),(0,e._)("tfoot",null,[(0,e._)("tr",null,[$,y,L,x,(0,e._)("td",D,[(0,e.Uk)("總計： "+(0,i.zw)(t.$filters.currency(A.cartData.total))+" ",1),A.cartData.final_total!==A.cartData.total?((0,e.wg)(),(0,e.iD)("span",S,[M,(0,e.Uk)("優惠價： "+(0,i.zw)(t.$filters.currency(A.cartData.final_total)),1)])):(0,e.kq)("",!0)])])])]),(0,e._)("div",T,[(0,e.wy)((0,e._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=t=>A.coupon_code=t),placeholder:"請輸入優惠代碼"},null,512),[[o.nr,A.coupon_code]]),(0,e._)("div",P,[(0,e._)("button",{class:"btn btn-outline-info",type:"button",onClick:a[2]||(a[2]=(...t)=>F.addCouponCode&&F.addCouponCode(...t))}," 輸入優惠代碼 ")])]),(0,e._)("button",{type:"button",class:"btn btn-danger btn-lg d-block mx-auto mb-3",disabled:0==A.cartData.final_total,onClick:a[3]||(a[3]=(0,o.iM)(((...t)=>F.goToSheet&&F.goToSheet(...t)),["prevent"]))}," 前往結帳 ",8,I)])):((0,e.wg)(),(0,e.iD)("div",z,[q,U,(0,e._)("button",{type:"button",class:"btn btn-danger btn-lg d-block mx-auto my-3",onClick:a[4]||(a[4]=(0,o.iM)(((...t)=>F.goToProducts&&F.goToProducts(...t)),["prevent"]))}," 參觀選購 ")]))])}var A=s(4902),F={data(){return{cartData:{},products:[],productId:"",isLoadingitem:"",isLoading:!1,fullPage:!0,form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:"",forToastFalse:{data:{success:0}}}},methods:{getProducts(){const t=this;t.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/tsuei/products/all").then((a=>{this.products=a.data.products,t.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/tsuei/cart").then((t=>{this.cartData=t.data.data})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},updateCartItem(t){const a={product_id:t.id,qty:t.qty},s=this;s.isLoading=!0,this.isLoadingitem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/tsuei/cart/${t.id}`,{data:a}).then((t=>{this.getCart(),this.isLoadingitem="",s.isLoading=!1,this.$httpMessageState(t,"已更新購物車")})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},removeCartItem(t){const a=this;a.isLoading=!0,this.isLoadingitem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/tsuei/cart/${t}`).then((()=>{A.Z.emit("get-cart"),this.getCart(),this.isLoadingitem="",a.isLoading=!1,this.$httpMessageState(this.forToastFalse,"已刪除該品項")})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},removeAllCart(){const t=this;t.isLoading=!0,this.isLoadingitem=1,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/tsuei/carts").then((()=>{this.isLoadingitem="",A.Z.emit("get-cart"),this.getCart(),t.isLoading=!1,this.$httpMessageState(this.forToastFalse,"已刪除全部購物車")})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/v2/api/tsuei/coupon",a={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:a}).then((t=>{this.$httpMessageState(t,"加入優惠券"),this.getCart(),this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"無此優惠券")}))},goToSheet(){this.$router.push("/cartrecipient")},goToProducts(){this.$router.push("/products")}},mounted(){this.getProducts(),this.getCart()}},V=s(3744);const Z=(0,V.Z)(F,[["render",E]]);var H=Z}}]);
//# sourceMappingURL=564.32146abb.js.map