"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[424],{9707:function(t,e,l){l.d(e,{Z:function(){return _}});var a=l(6252),o=l(3577),s=l(9963);const d={"aria-label":"Page navigation example"},i={class:"pagination"},r=(0,a._)("span",{"aria-hidden":"true"},"«",-1),c=[r],n=["onClick"],p=(0,a._)("span",{"aria-hidden":"true"},"»",-1),u=[p];function m(t,e,l,r,p,m){return(0,a.wg)(),(0,a.iD)("nav",d,[(0,a._)("ul",i,[(0,a._)("li",{class:(0,o.C_)(["page-item",{disabled:!l.pages.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,s.iM)((t=>m.getPages(l.pages.current_page-1)),["prevent"]))},c)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:(0,o.C_)(["page-item",{active:t===l.pages.current_page}]),key:t+"page"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((e=>m.getPages(t)),["prevent"])},(0,o.zw)(t),9,n)],2)))),128)),(0,a._)("li",{class:(0,o.C_)(["page-item",{disabled:!l.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,s.iM)((t=>m.getPages(l.pages.current_page+1)),["prevent"]))},u)],2)])])}var g={props:["pages"],methods:{getPages(t){this.$emit("getPages",t)}}},h=l(3744);const b=(0,h.Z)(g,[["render",m]]);var _=b},6424:function(t,e,l){l.r(e),l.d(e,{default:function(){return vt}});var a=l(6252),o=l(3577);const s={class:"container-fluid"},d={class:"text-end mt-4"},i={class:"table mt-4"},r=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"120"},"分類"),(0,a._)("th",null,"產品名稱"),(0,a._)("th",{width:"120"},"原價"),(0,a._)("th",{width:"120"},"售價"),(0,a._)("th",{width:"100"},"是否啟用"),(0,a._)("th",{width:"120"},"編輯")])],-1),c={key:0,class:"text-success"},n={key:1},p={class:"btn-group"},u=["onClick"],m=["onClick"],g={class:"container mx-auto"};function h(t,e,l,h,b,_){const P=(0,a.up)("Pagination"),f=(0,a.up)("productModal"),w=(0,a.up)("delProductModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("div",d,[(0,a._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>_.openModal("new"))}," 建立新的產品 ")]),(0,a._)("table",i,[r,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,(0,o.zw)(t.category),1),(0,a._)("td",null,(0,o.zw)(t.title),1),(0,a._)("td",null,(0,o.zw)(t.origin_price),1),(0,a._)("td",null,(0,o.zw)(t.price),1),(0,a._)("td",null,[t.is_enabled?((0,a.wg)(),(0,a.iD)("span",c,"啟用")):((0,a.wg)(),(0,a.iD)("span",n,"未啟用"))]),(0,a._)("td",null,[(0,a._)("div",p,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>_.openModal("edit",t)}," 編輯 ",8,u),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>_.openModal("delete",t)}," 刪除 ",8,m)])])])))),128))])])]),(0,a._)("div",g,[(0,a.Wm)(P,{pages:b.pages,onGetPages:_.getProducts},null,8,["pages","onGetPages"])]),(0,a.Wm)(f,{product:b.tempProduct,"is-new":b.isNew,onUpdateProduct:_.updateProduct,ref:"productModal"},null,8,["product","is-new","onUpdateProduct"]),(0,a.Wm)(w,{"temp-product":b.tempProduct,onDelItem:_.delProduct,ref:"delProductModal"},null,8,["temp-product","onDelItem"])],64)}var b=l(9707),_=l(9577),P=l(9963);const f={id:"productModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true",role:"dialog"},w={class:"modal-dialog modal-xl"},v={class:"modal-content border-0"},y={class:"modal-header bg-dark text-white"},k={id:"productModalLabel",class:"modal-title"},M={key:0},U={key:1},x=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),C={class:"modal-body"},D={class:"row"},$={class:"col-sm-4"},V={class:"mb-2"},N={class:"mb-3"},Z=(0,a._)("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),z=["src"],L=(0,a._)("h3",{class:"mb-3"},"多圖新增",-1),H={key:0},I={class:"mb-3"},Y=(0,a._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),K=["onUpdate:modelValue"],W=["src"],A={key:0},G={key:1},j={key:1},B={class:"col-sm-8"},F={class:"mb-3"},O=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),S={class:"row"},T={class:"mb-3 col-md-6"},q=(0,a._)("label",{for:"category",class:"form-label"},"分類",-1),E={class:"mb-3 col-md-6"},J=(0,a._)("label",{for:"price",class:"form-label"},"單位",-1),Q={class:"row"},R={class:"mb-3 col-md-6"},X=(0,a._)("label",{for:"origin_price",class:"form-label"},"原價",-1),tt={class:"mb-3 col-md-6"},et=(0,a._)("label",{for:"price",class:"form-label"},"售價",-1),lt=(0,a._)("hr",null,null,-1),at={class:"mb-3"},ot=(0,a._)("label",{for:"description",class:"form-label"},"產品描述",-1),st={class:"mb-3"},dt=(0,a._)("label",{for:"content",class:"form-label"},"說明內容",-1),it={class:"mb-3"},rt={class:"form-check"},ct=(0,a._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),nt={class:"modal-footer"},pt=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ut(t,e,l,o,s,d){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",w,[(0,a._)("div",v,[(0,a._)("div",y,[(0,a._)("h5",k,[l.isNew?((0,a.wg)(),(0,a.iD)("span",M,"新增產品")):((0,a.wg)(),(0,a.iD)("span",U,"編輯產品"))]),x]),(0,a._)("div",C,[(0,a._)("div",D,[(0,a._)("div",$,[(0,a._)("div",V,[(0,a._)("div",N,[Z,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>s.tempProduct.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[P.nr,s.tempProduct.imageUrl]]),(0,a._)("img",{class:"img-fluid",src:s.tempProduct.imageUrl},null,8,z)])]),L,Array.isArray(s.tempProduct.imagesUrl)?((0,a.wg)(),(0,a.iD)("div",H,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.tempProduct.imagesUrl,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{class:"mb-1",key:e},[(0,a._)("div",I,[Y,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t=>s.tempProduct.imagesUrl[e]=t,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,K),[[P.nr,s.tempProduct.imagesUrl[e]]])]),(0,a._)("img",{class:"img-fluid",src:t},null,8,W)])))),128)),!s.tempProduct.imagesUrl.length||s.tempProduct.imagesUrl[s.tempProduct.imagesUrl.length-1]?((0,a.wg)(),(0,a.iD)("div",A,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=t=>s.tempProduct.imagesUrl.push(""))}," 新增圖片欄 ")])):((0,a.wg)(),(0,a.iD)("div",G,[(0,a._)("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>s.tempProduct.imagesUrl.pop())}," 刪除圖片欄 ")]))])):((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=(...e)=>t.createImages&&t.createImages(...e))}," 新增圖片 ")]))]),(0,a._)("div",B,[(0,a._)("div",F,[O,(0,a.wy)((0,a._)("input",{id:"title","onUpdate:modelValue":e[4]||(e[4]=t=>s.tempProduct.title=t),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[P.nr,s.tempProduct.title]])]),(0,a._)("div",S,[(0,a._)("div",T,[q,(0,a.wy)((0,a._)("input",{id:"category","onUpdate:modelValue":e[5]||(e[5]=t=>s.tempProduct.category=t),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[P.nr,s.tempProduct.category]])]),(0,a._)("div",E,[J,(0,a.wy)((0,a._)("input",{id:"unit","onUpdate:modelValue":e[6]||(e[6]=t=>s.tempProduct.unit=t),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[P.nr,s.tempProduct.unit]])])]),(0,a._)("div",Q,[(0,a._)("div",R,[X,(0,a.wy)((0,a._)("input",{id:"origin_price","onUpdate:modelValue":e[7]||(e[7]=t=>s.tempProduct.origin_price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[P.nr,s.tempProduct.origin_price,void 0,{number:!0}]])]),(0,a._)("div",tt,[et,(0,a.wy)((0,a._)("input",{id:"price","onUpdate:modelValue":e[8]||(e[8]=t=>s.tempProduct.price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[P.nr,s.tempProduct.price,void 0,{number:!0}]])])]),lt,(0,a._)("div",at,[ot,(0,a.wy)((0,a._)("textarea",{id:"description","onUpdate:modelValue":e[9]||(e[9]=t=>s.tempProduct.description=t),type:"text",class:"form-control",placeholder:"請輸入產品描述"},"\n                                ",512),[[P.nr,s.tempProduct.description]])]),(0,a._)("div",st,[dt,(0,a.wy)((0,a._)("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=t=>s.tempProduct.content=t),type:"text",class:"form-control",placeholder:"請輸入說明內容"},"\n                                ",512),[[P.nr,s.tempProduct.content]])]),(0,a._)("div",it,[(0,a._)("div",rt,[(0,a.wy)((0,a._)("input",{id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=t=>s.tempProduct.is_enabled=t),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[P.e8,s.tempProduct.is_enabled]]),ct])])])])]),(0,a._)("div",nt,[pt,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=e=>t.$emit("update-product",s.tempProduct))}," 確認 ")])])])],512)}var mt=l(7424),gt=l.n(mt),ht={data(){return{modal:"",tempProduct:{}}},props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},emits:["update-product"],watch:{product(){this.tempProduct=this.product}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(gt())(this.$refs.modal)}},bt=l(3744);const _t=(0,bt.Z)(ht,[["render",ut]]);var Pt=_t,ft={data(){return{temp:{},products:[],isNew:!1,tempProduct:{imagesUrl:[]},pages:{},isLoading:!1,forToastFalse:{data:{success:0}}}},components:{delProductModal:_.Z,Pagination:b.Z,productModal:Pt},methods:{getProducts(t=1){const e=this;e.isLoading=!0,this.$http(`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/products?page=${t}`).then((t=>{this.products=t.data.products,this.pages=t.data.pagination,e.isLoading=!1})).catch((t=>{this.$httpMessageState(t.response,"錯誤！")}))},openModal(t,e){if("new"===t){this.tempProduct={imagesUrl:[]},this.isNew=!0;const t=this.$refs.productModal;t.openModal()}else if("edit"===t){this.tempProduct={...e},this.isNew=!1;const t=this.$refs.productModal;t.openModal()}else if("delete"===t){this.tempProduct={...e};const t=this.$refs.delProductModal;t.openModal()}},updateProduct(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/product",l="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/product/${this.tempProduct.id}`,l="put");const a=this.$refs.productModal;this.$http[l](e,{data:this.tempProduct}).then((t=>{alert(t.data.message),a.hideModal(),this.getProducts()})).catch((t=>{alert(t.response)}))},delProduct(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/product/${this.tempProduct.id}`).then((t=>{const e=this.$refs.delProductModal;e.hideModal(),alert("已刪除該產品"),this.getProducts()})).catch((t=>{alert(t.data.message)}))}},mounted(){this.getProducts()}};const wt=(0,bt.Z)(ft,[["render",h]]);var vt=wt}}]);
//# sourceMappingURL=424.f62bc681.js.map