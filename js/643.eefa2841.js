"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[643],{9707:function(e,t,l){l.d(t,{Z:function(){return b}});var a=l(6252),r=l(3577),d=l(9963);const s={"aria-label":"Page navigation example"},n={class:"pagination"},i=(0,a._)("span",{"aria-hidden":"true"},"«",-1),o=[i],u=["onClick"],c=(0,a._)("span",{"aria-hidden":"true"},"»",-1),p=[c];function _(e,t,l,i,c,_){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("ul",n,[(0,a._)("li",{class:(0,r.C_)(["page-item",{disabled:!l.pages.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,d.iM)((e=>_.getPages(l.pages.current_page-1)),["prevent"]))},o)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,r.C_)(["page-item",{active:e===l.pages.current_page}]),key:e+"page"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,d.iM)((t=>_.getPages(e)),["prevent"])},(0,r.zw)(e),9,u)],2)))),128)),(0,a._)("li",{class:(0,r.C_)(["page-item",{disabled:!l.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,d.iM)((e=>_.getPages(l.pages.current_page+1)),["prevent"]))},p)],2)])])}var h={props:["pages"],methods:{getPages(e){this.$emit("getPages",e)}}},m=l(3744);const g=(0,m.Z)(h,[["render",_]]);var b=g},643:function(e,t,l){l.r(t),l.d(t,{default:function(){return _e}});var a=l(6252),r=l(3577),d=l(9963);const s={class:"container-fluid"},n={class:"table mt-4"},i=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"訂單時間"),(0,a._)("th",null,"聯絡方式"),(0,a._)("th",null,"訂單內容"),(0,a._)("th",null,"訂單金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯訂單")])],-1),o={class:"list-unstyled"},u={class:"form-check form-switch"},c=["onChange","id","onUpdate:modelValue"],p={class:"form-check-label",for:"flexSwitchCheckChecked"},_={key:0},h={key:1},m={class:"btn-group"},g=["onClick"],b=["onClick"],w={class:"container mx-auto"};function f(e,t,l,f,k,O){const y=(0,a.up)("Pagination"),v=(0,a.up)("orderModal"),M=(0,a.up)("delProductModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("table",n,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.orders,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id,class:(0,r.C_)({"text-secondary":!t.is_paid})},[(0,a._)("td",null,(0,r.zw)(e.$filters.date(t.create_at)),1),(0,a._)("td",null,(0,r.zw)(t.user.email),1),(0,a._)("td",null,[(0,a._)("ul",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},(0,r.zw)(e.product.title)+" 數量: "+(0,r.zw)(e.qty)+" "+(0,r.zw)(e.product.unit),1)))),128))])]),(0,a._)("td",null,(0,r.zw)(e.$filters.currency(t.total)),1),(0,a._)("td",null,[(0,a._)("div",u,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",onChange:e=>O.updateOrder(t),role:"switch",id:t.id,"onUpdate:modelValue":e=>t.is_paid=e},null,40,c),[[d.e8,t.is_paid]]),(0,a._)("label",p,[t.is_paid?((0,a.wg)(),(0,a.iD)("span",_,"已付款")):((0,a.wg)(),(0,a.iD)("span",h,"未付款"))])])]),(0,a._)("td",null,[(0,a._)("div",m,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>O.openModal("edit",t)}," 更多 ",8,g),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>O.openModal("delete",t)}," 刪除 ",8,b)])])],2)))),128))])])]),(0,a._)("div",w,[(0,a.Wm)(y,{pages:k.pages,onGetPages:O.getOrders},null,8,["pages","onGetPages"])]),(0,a.Wm)(v,{order:k.tempOrder,onUpdateOrder:O.updateOrder,ref:"orderModal"},null,8,["order","onUpdateOrder"]),(0,a.Wm)(M,{"temp-product":k.tempOrder,onDelItem:O.delOrder,ref:"delProductModal"},null,8,["temp-product","onDelItem"])],64)}var k=l(9707),O=l(9577);const y={id:"orderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true",role:"dialog"},v={class:"modal-dialog modal-xl"},M={class:"modal-content border-0"},C=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{id:"productModalLabel",class:"modal-title"}," 訂單內容 "),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},$={class:"row"},z={class:"col-sm-4"},x={class:"table"},P=(0,a._)("h3",null,"訂購者資訊",-1),Z={key:0},H=(0,a._)("th",null,"姓名",-1),L=(0,a._)("th",null,"Email",-1),U=(0,a._)("th",null,"電話",-1),Y=(0,a._)("th",null,"地址",-1),K=(0,a._)("h3",null,"付款資訊",-1),q=(0,a._)("th",null,"訂單金額",-1),N=(0,a._)("th",null,"付款狀態",-1),V={key:0,class:"text-success"},W={key:1,class:"text-danger"},j={class:"col-sm-8"},G={class:"table"},I=(0,a._)("h3",null,"訂單資訊",-1),S=(0,a._)("th",null,"訂單編號",-1),E=(0,a._)("th",null,"訂單時間",-1),A=(0,a._)("th",null,"付款時間",-1),B={key:0},F={key:1},J=(0,a._)("h3",{class:"mt-5"},"訂購清單",-1),Q={class:"text-end"},R={class:"d-flex justify-content-end"},T={class:"form-check"},X={class:"form-check-label",for:"OrderCheck"},ee={key:0},te={key:1},le={class:"modal-footer"},ae=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function re(e,t,l,s,n,i){return(0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",v,[(0,a._)("div",M,[C,(0,a._)("div",D,[(0,a._)("div",$,[(0,a._)("div",z,[(0,a._)("table",x,[P,n.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",Z,[(0,a._)("tr",null,[H,(0,a._)("td",null,(0,r.zw)(n.tempOrder.user.name),1)]),(0,a._)("tr",null,[L,(0,a._)("td",null,(0,r.zw)(n.tempOrder.user.email),1)]),(0,a._)("tr",null,[U,(0,a._)("td",null,(0,r.zw)(n.tempOrder.user.tel),1)]),(0,a._)("tr",null,[Y,(0,a._)("td",null,(0,r.zw)(n.tempOrder.user.address),1)])])):(0,a.kq)("",!0),K,(0,a._)("tfoot",null,[(0,a._)("tr",null,[q,(0,a._)("td",null,(0,r.zw)(e.$filters.currency(n.tempOrder.total)),1)]),(0,a._)("tr",null,[N,(0,a._)("td",null,[n.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",V,"已付款")):((0,a.wg)(),(0,a.iD)("span",W,"尚未付款"))])])])])]),(0,a._)("div",j,[(0,a._)("table",G,[I,(0,a._)("tbody",null,[(0,a._)("tr",null,[S,(0,a._)("td",null,(0,r.zw)(n.tempOrder.id),1)]),(0,a._)("tr",null,[E,(0,a._)("td",null,(0,r.zw)(e.$filters.date(n.tempOrder.create_at)),1)]),(0,a._)("tr",null,[A,(0,a._)("td",null,[n.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",B,(0,r.zw)(e.$filters.date(n.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",F,"時間有誤"))])])]),J,(0,a._)("tfoot",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.tempOrder.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",null,(0,r.zw)(t.product.title),1),(0,a._)("td",null,(0,r.zw)(t.qty)+" / "+(0,r.zw)(t.product.unit),1),(0,a._)("td",Q,(0,r.zw)(e.$filters.currency(t.final_total)),1)])))),128))])])])]),(0,a._)("div",R,[(0,a._)("div",T,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"OrderCheck","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempOrder.is_paid=e)},null,512),[[d.e8,n.tempOrder.is_paid]]),(0,a._)("label",X,[n.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("span",ee,"已付款")):((0,a.wg)(),(0,a.iD)("span",te,"未付款"))])])])]),(0,a._)("div",le,[ae,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=t=>e.$emit("update-order",n.tempOrder))}," 確認 ")])])])],512)}var de=l(7424),se=l.n(de),ne={data(){return{modal:"",tempOrder:{}}},props:{order:{type:Object,default(){return{}}}},emits:["update-order"],watch:{order(){this.tempOrder=this.order}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(se())(this.$refs.modal)}},ie=l(3744);const oe=(0,ie.Z)(ne,[["render",re]]);var ue=oe,ce={data(){return{orders:{},isNew:!1,tempOrder:{},pages:{},isLoading:!1}},components:{delProductModal:O.Z,Pagination:k.Z,orderModal:ue},methods:{getOrders(e=1){const t=this;t.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/orders?page=${e}`).then((e=>{this.orders=e.data.orders,this.pages=e.data.pagination,t.isLoading=!1})).catch((e=>{this.$httpMessageState(e.response,"錯誤！")}))},openModal(e,t){if("edit"===e){this.tempOrder={...t},this.isNew=!1;const e=this.$refs.orderModal;e.openModal()}else if("delete"===e){this.tempOrder={...t};const e=this.$refs.delProductModal;e.openModal()}},updateOrder(e){this.tempOrder=e;const t=`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/order/${e.id}`,l={is_paid:e.is_paid},a=this.$refs.orderModal;this.$http.put(t,{data:l}).then((e=>{alert(e.data.message),a.hideModal(),this.getOrders()})).catch((e=>{alert(e.response)}))},delOrder(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/tsuei/admin/order/${this.tempOrder.id}`).then((e=>{const t=this.$refs.delProductModal;t.hideModal(),alert("已刪除該訂單"),this.getOrders()})).catch((e=>{alert(e.data.message)}))}},mounted(){this.getOrders()}};const pe=(0,ie.Z)(ce,[["render",f]]);var _e=pe}}]);
//# sourceMappingURL=643.eefa2841.js.map